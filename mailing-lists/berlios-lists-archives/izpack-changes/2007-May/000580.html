<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [izpack-changes] r1834 - in izpack-src/trunk: .	bin/langpacks/installer src src/dist-files src/doc-ng/XHTML	src/lib/com/izforge/izpack/compiler	src/lib/com/izforge/izpack/installer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:izpack-changes%40lists.berlios.de?Subject=%5Bizpack-changes%5D%20r1834%20-%20in%20izpack-src/trunk%3A%20.%0A%09bin/langpacks/installer%20src%20src/dist-files%20src/doc-ng/XHTML%0A%09src/lib/com/izforge/izpack/compiler%0A%09src/lib/com/izforge/izpack/installer&In-Reply-To=">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000579.html">
   <LINK REL="Next"  HREF="000581.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[izpack-changes] r1834 - in izpack-src/trunk: .	bin/langpacks/installer src src/dist-files src/doc-ng/XHTML	src/lib/com/izforge/izpack/compiler	src/lib/com/izforge/izpack/installer</H1>
    <B>noreply at berlios.de</B> 
    <A HREF="mailto:izpack-changes%40lists.berlios.de?Subject=%5Bizpack-changes%5D%20r1834%20-%20in%20izpack-src/trunk%3A%20.%0A%09bin/langpacks/installer%20src%20src/dist-files%20src/doc-ng/XHTML%0A%09src/lib/com/izforge/izpack/compiler%0A%09src/lib/com/izforge/izpack/installer&In-Reply-To="
       TITLE="[izpack-changes] r1834 - in izpack-src/trunk: .	bin/langpacks/installer src src/dist-files src/doc-ng/XHTML	src/lib/com/izforge/izpack/compiler	src/lib/com/izforge/izpack/installer">noreply at berlios.de
       </A><BR>
    <I>Mon May 14 13:45:48 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000579.html">[izpack-changes] r1833 - in izpack-src/trunk: . src/dist-files
</A></li>
        <LI>Next message: <A HREF="000581.html">[izpack-changes] r1835 - in izpack-src/trunk: . lib	src/doc-ng/XHTML src/lib/com/izforge/izpack/installer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#580">[ date ]</a>
              <a href="thread.html#580">[ thread ]</a>
              <a href="subject.html#580">[ subject ]</a>
              <a href="author.html#580">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: jponge
Date: 2007-05-14 13:45:44 +0200 (Mon, 14 May 2007)
New Revision: 1834

Modified:
   izpack-src/trunk/Versions.txt
   izpack-src/trunk/bin/langpacks/installer/fra.xml
   izpack-src/trunk/src/build.xml
   izpack-src/trunk/src/dist-files/IzPack-install.xml
   izpack-src/trunk/src/doc-ng/XHTML/node9.html
   izpack-src/trunk/src/lib/com/izforge/izpack/compiler/Compiler.java
   izpack-src/trunk/src/lib/com/izforge/izpack/installer/AutomatedInstaller.java
Log:
Merged -r1817:1833 from branches/3.10

Modified: izpack-src/trunk/Versions.txt
===================================================================
--- izpack-src/trunk/Versions.txt	2007-05-12 21:42:52 UTC (rev 1833)
+++ izpack-src/trunk/Versions.txt	2007-05-14 11:45:44 UTC (rev 1834)
@@ -1,6 +1,10 @@
 [ The list of the different public versions of IzPack ]
 
+&lt;&lt;&lt;&lt;&lt;&lt;&lt; .courant
   &gt; Next major release
+=======
+  &gt; 3.10.2 (build 2007.05.11)
+&gt;&gt;&gt;&gt;&gt;&gt;&gt; .fusion-droit.r1833
 
 - Added ignore as possible value for failure argument in executables (Dennis Reil)
 - Added Conditional expressions (Dennis Reil)
@@ -18,7 +22,7 @@
 - Locale support of Shortcut specification file (Klaus Bartz using a hint of Loic)
 - Enabled distributed pack-definitions (Hans Aikema based on patch by Syed Khadeer)
 
-  &gt; 3.10.2
+  &gt; 3.10.2 (build 2007.05.11)
 
 - Vista/Java6 fixes (Stefan Wachter via Julien Ponge)
 - Dutch Langpack fixes (Hans Aikema)
@@ -26,6 +30,8 @@
 - Indonesian Langpack fixes (Thomas Santosa via Hans Aikema)
 - UserInputPanel and InstallerFrame: enable the next button for search dialogs (Michael Hagedorn via Julien Ponge)
 - VariableSubstitutor: new Java source files support (Max Fedorov via Julien Ponge)
+- French langpack updates (Loic, via Julien Ponge)
+- Documentation update (Scott Plante via Julien Ponge)
 - AutomatedUninstaller.writeUninstallData() out of sync with InstallerFrame fixed (Marius Nicolae via Marc Eppelmann)
 
   &gt; 3.10.1 (build 2007.03.29)

Modified: izpack-src/trunk/bin/langpacks/installer/fra.xml
===================================================================
--- izpack-src/trunk/bin/langpacks/installer/fra.xml	2007-05-12 21:42:52 UTC (rev 1833)
+++ izpack-src/trunk/bin/langpacks/installer/fra.xml	2007-05-14 11:45:44 UTC (rev 1834)
@@ -86,6 +86,11 @@
     &lt;str id=&quot;InstallPanel.overwrite.title&quot; txt=&quot;Le fichier existe d&#233;j&#224;.&quot;/&gt;
     &lt;str id=&quot;InstallPanel.overwrite.question&quot; txt=&quot;Le fichier suivant existe d&#233;j&#224;. Faut-il l'&#233;craser ?&quot;/&gt;
     
+    &lt;!-- InstallationGroupPanel strings --&gt;
+    &lt;str id=&quot;InstallationGroupPanel.colNameSelected&quot; txt=&quot;Groupe &#195;&#160; installer&quot; /&gt;
+    &lt;str id=&quot;InstallationGroupPanel.colNameInstallType&quot; txt=&quot;Description&quot; /&gt;
+    &lt;str id=&quot;InstallationGroupPanel.colNameSize&quot; txt=&quot;Taille&quot; /&gt;
+	
     &lt;!-- FinishPanel strings --&gt;
     &lt;str id=&quot;FinishPanel.success&quot; txt=&quot;L'installation est r&#233;ussie !&quot;/&gt;
     &lt;str id=&quot;FinishPanel.done&quot; txt=&quot;Terminer&quot;/&gt;

Modified: izpack-src/trunk/src/build.xml
===================================================================
--- izpack-src/trunk/src/build.xml	2007-05-12 21:42:52 UTC (rev 1833)
+++ izpack-src/trunk/src/build.xml	2007-05-14 11:45:44 UTC (rev 1834)
@@ -204,7 +204,7 @@
 
     &lt;property file=&quot;src/ant.properties&quot; /&gt;
     &lt;property name=&quot;ver&quot; value=&quot;3.10&quot; /&gt;
-    &lt;property name=&quot;rel&quot; value=&quot;1&quot; /&gt;
+    &lt;property name=&quot;rel&quot; value=&quot;2&quot; /&gt;
     &lt;property name=&quot;build.number&quot; value=&quot;${ver}.${rel}&quot; /&gt;
 
     &lt;property name=&quot;src.dir&quot; value=&quot;${basedir}/src/lib&quot; /&gt;

Modified: izpack-src/trunk/src/dist-files/IzPack-install.xml
===================================================================
--- izpack-src/trunk/src/dist-files/IzPack-install.xml	2007-05-12 21:42:52 UTC (rev 1833)
+++ izpack-src/trunk/src/dist-files/IzPack-install.xml	2007-05-14 11:45:44 UTC (rev 1834)
@@ -23,11 +23,13 @@
     &lt;!-- The info section --&gt;
     &lt;info&gt;
         &lt;appname&gt;IzPack&lt;/appname&gt;
-        &lt;appversion&gt;3.10.1&lt;/appversion&gt;
+        &lt;appversion&gt;3.10.2&lt;/appversion&gt;
         &lt;authors&gt;
             &lt;author email=&quot;&quot; name=&quot;Julien Ponge (maintainer and original developer)&quot;/&gt;
 
             &lt;author email=&quot;&quot; name=&quot;Klaus Bartz (developer)&quot;/&gt;
+            &lt;author email=&quot;&quot; name=&quot;Hans Aikema (developer)&quot; /&gt;
+            &lt;author email=&quot;&quot; name=&quot;Marc Eppelmann (developer)&quot; /&gt;
             &lt;author email=&quot;&quot; name=&quot;Fabrice Mirabile (developer)&quot;/&gt;
             &lt;author email=&quot;&quot; name=&quot;Dennis Reil (developer)&quot; /&gt;
             &lt;author email=&quot;&quot; name=&quot;JBoss/RedHat: Vladimir Ralev (developers)&quot; /&gt;
@@ -40,6 +42,11 @@
             &lt;author email=&quot;&quot; name=&quot;Stefan Wachter (contributor)&quot; /&gt;
             &lt;author email=&quot;&quot; name=&quot;Romain Guy (contributor)&quot; /&gt;
             &lt;author email=&quot;&quot; name=&quot;Melih Cetin (contributor)&quot; /&gt;
+            &lt;author email=&quot;&quot; name=&quot;Thomas Santosa (contributor)&quot; /&gt;
+            &lt;author email=&quot;&quot; name=&quot;Michael Hagedorn (contributor)&quot; /&gt;
+            &lt;author email=&quot;&quot; name=&quot;Max Fedorov (contributor)&quot; /&gt;
+            &lt;author email=&quot;&quot; name=&quot;Scott Plante (contributor)&quot; /&gt;
+            &lt;author email=&quot;&quot; name=&quot;Marius Nicolae (contributor)&quot; /&gt;
 
             &lt;author email=&quot;&quot;
                     name=&quot;... the (many) other developers and contributors to the previous releases!&quot;/&gt;

Modified: izpack-src/trunk/src/doc-ng/XHTML/node9.html
===================================================================
--- izpack-src/trunk/src/doc-ng/XHTML/node9.html	2007-05-12 21:42:52 UTC (rev 1833)
+++ izpack-src/trunk/src/doc-ng/XHTML/node9.html	2007-05-14 11:45:44 UTC (rev 1834)
@@ -450,20 +450,26 @@
         [IzPackRoot]/src/lib/[MyPackagePath]/MyCompilerListener.java&lt;/tt&gt;.
       &lt;/li&gt;
       &lt;li&gt;
-        Add a &quot;compile.simple&quot; antcall in to &lt;tt&gt;[IzPackRoot]/src/build.xml&lt;/tt&gt;. 
+        Add a &quot;&lt;tt&gt;build-compiler-listener&lt;/tt&gt;&quot; macro call in to the 
+        &lt;tt&gt;build.listeners&lt;/tt&gt; target in &lt;tt&gt;[IzPackRoot]/src/build.xml&lt;/tt&gt;.
+        Note that the name attribute value in the build-instealler-listener 
+        must match &lt;tt&gt;CompilerListener&lt;/tt&gt; implementation class name (not 
+        including the package). You should include the actual Listener
+        implementation, as well as any other classes required by the listener.
 &lt;pre&gt;
-&amp;lt;antcall target=&quot;compile.listener.simple&quot;&amp;gt;
-  &amp;lt;param name=&quot;listener&quot; value=&quot;MyCompilerListener&quot;/&amp;gt;
-  &amp;lt;param name=&quot;listener-dir&quot; value=&quot;MyCompilerListener&quot;/&amp;gt;
-  &amp;lt;param name=&quot;listener-include&quot; value=&quot;[MyPackagePath]&quot;/&amp;gt;
-&amp;lt;/antcall&amp;gt;
+        &amp;lt;build-compiler-listener name=&quot;MyCompilerListener&quot;&amp;gt;
+            &amp;lt;include name=&quot;[MyPackagePath]/MyCompilerListener.java&quot;/&amp;gt;
+            &amp;lt;include name=&quot;[MyPackagePath]/SomeOtherHelperClass.java&quot;/&amp;gt;
+        &amp;lt;/build-compiler-listener&amp;gt;
 &lt;/pre&gt;
       &lt;/li&gt;
       &lt;li&gt;
         Run &lt;tt&gt;[IzPackRoot]/src/build.xml&lt;/tt&gt;.
+        An &lt;tt&gt;ant&lt;/tt&gt; alone will execute the required targets.
       &lt;/li&gt;
       &lt;li&gt;
-        Add a &quot;listeners&quot; ELEMENT with a &quot;listener&quot; ELEMENT with a &quot;compiler&quot; attribute in to [MyProjectPath]/install.xml 
+        Add a &quot;listeners&quot; ELEMENT with a &quot;listener&quot; ELEMENT with a &quot;compiler&quot;
+        attribute in to [MyProjectPath]/install.xml 
 &lt;pre&gt;
   &amp;lt;listeners&amp;gt;
     &amp;lt;listener compiler=&quot;MyCompilerListener&quot; /&amp;gt;
@@ -471,7 +477,7 @@
 &lt;/pre&gt;
       &lt;/li&gt;
       &lt;li&gt;
-        Compile with 
+        Compile with the following command, or an ant task you have set up.
 &lt;pre&gt;
 java -jar [IzPackRoot]/lib/compiler.jar -HOME [IzPackRoot]
   [MyProjectPath]/install.xml -b [MyProductPath] -o

Modified: izpack-src/trunk/src/lib/com/izforge/izpack/compiler/Compiler.java
===================================================================
--- izpack-src/trunk/src/lib/com/izforge/izpack/compiler/Compiler.java	2007-05-12 21:42:52 UTC (rev 1833)
+++ izpack-src/trunk/src/lib/com/izforge/izpack/compiler/Compiler.java	2007-05-14 11:45:44 UTC (rev 1834)
@@ -64,7 +64,7 @@
 public class Compiler extends Thread
 {
     /** The IzPack version. */
-    public final static String IZPACK_VERSION = &quot;3.10.1&quot;;
+    public final static String IZPACK_VERSION = &quot;3.10.2&quot;;
 
     /** The IzPack home directory. */
     public static String IZPACK_HOME = &quot;.&quot;;

Modified: izpack-src/trunk/src/lib/com/izforge/izpack/installer/AutomatedInstaller.java
===================================================================
--- izpack-src/trunk/src/lib/com/izforge/izpack/installer/AutomatedInstaller.java	2007-05-12 21:42:52 UTC (rev 1833)
+++ izpack-src/trunk/src/lib/com/izforge/izpack/installer/AutomatedInstaller.java	2007-05-14 11:45:44 UTC (rev 1834)
@@ -28,15 +28,17 @@
 import java.io.ObjectOutputStream;
 import java.io.OutputStreamWriter;
 import java.io.ByteArrayOutputStream;
+
 import java.util.Iterator;
 import java.util.Map;
 import java.util.List;
+import java.util.Map;
+import java.util.TreeMap;
+import java.util.Vector;
 import java.util.ArrayList;
 import java.util.HashSet;
-import java.util.TreeMap;
-import java.util.Vector;
+import java.util.zip.ZipEntry;
 import java.util.zip.ZipException;
-import java.util.zip.ZipEntry;
 import java.util.zip.ZipOutputStream;
 
 import net.n3.nanoxml.NonValidator;
@@ -107,6 +109,7 @@
         this.panelInstanceCount = new TreeMap();
     }
 
+   
     /**
      * Writes the uninstalldata.
      * 
@@ -164,130 +167,137 @@
             }
             execStream.flush();
             outJar.closeEntry();
-            
-             Map additionalData = udata.getAdditionalData();
-             if (additionalData != null &amp;&amp; !additionalData.isEmpty())
-             {
-                 Iterator keys = additionalData.keySet().iterator();
-                 HashSet exist = new HashSet();
-                 while (keys != null &amp;&amp; keys.hasNext())
-                 {
-                     String key = (String) keys.next();
-                     Object contents = additionalData.get(key);
-                     if (&quot;__uninstallLibs__&quot;.equals(key))
-                     {
-                         Iterator nativeLibIter = ((List) contents).iterator();
-                         while (nativeLibIter != null &amp;&amp; nativeLibIter.hasNext())
-                         {
-                             String nativeLibName = (String) ((List) nativeLibIter.next()).get(0);
-                             byte[] buffer = new byte[5120];
-                             long bytesCopied = 0;
-                             int bytesInBuffer;
-                             outJar.putNextEntry(new ZipEntry(&quot;native/&quot; + nativeLibName));
-                             InputStream in = getClass().getResourceAsStream(
-                                     &quot;/native/&quot; + nativeLibName);
-                             while ((bytesInBuffer = in.read(buffer)) != -1)
-                             {
-                                 outJar.write(buffer, 0, bytesInBuffer);
-                                 bytesCopied += bytesInBuffer;
-                             }
-                             outJar.closeEntry();
-                         }
-                     }
-                     else if (&quot;uninstallerListeners&quot;.equals(key) || &quot;uninstallerJars&quot;.equals(key))
-                     { // It is a ArrayList of ArrayLists which contains the
-                         // full
-                         // package paths of all needed class files.
-                         // First we create a new ArrayList which contains only
-                         // the full paths for the uninstall listener self; thats
-                         // the first entry of each sub ArrayList.
-                         ArrayList subContents = new ArrayList();
- 
-                         // Secound put the class into uninstaller.jar
-                         Iterator listenerIter = ((List) contents).iterator();
-                         while (listenerIter.hasNext())
-                         {
-                             byte[] buffer = new byte[5120];
-                             long bytesCopied = 0;
-                             int bytesInBuffer;
-                             CustomData customData = (CustomData) listenerIter.next();
-                             // First element of the list contains the listener
-                             // class path;
-                             // remind it for later.
-                             if (customData.listenerName != null)
-                                 subContents.add(customData.listenerName);
-                             Iterator liClaIter = customData.contents.iterator();
-                             while (liClaIter.hasNext())
-                             {
-                                 String contentPath = (String) liClaIter.next();
-                                 if (exist.contains(contentPath)) continue;
-                                 exist.add(contentPath);
-                                 try
-                                 {
-                                     outJar.putNextEntry(new ZipEntry(contentPath));
-                                 }
-                                 catch (ZipException ze)
-                                 { // Ignore, or ignore not ?? May be it is a
-                                     // exception because
-                                     // a doubled entry was tried, then we should
-                                     // ignore ...
-                                     Debug.trace(&quot;ZipException in writing custom data: &quot;
-                                             + ze.getMessage());
-                                     continue;
-                                 }
-                                 InputStream in = getClass().getResourceAsStream(&quot;/&quot; + contentPath);
-                                 if (in != null)
-                                 {
-                                     while ((bytesInBuffer = in.read(buffer)) != -1)
-                                     {
-                                         outJar.write(buffer, 0, bytesInBuffer);
-                                         bytesCopied += bytesInBuffer;
-                                     }
-                                 }
-                                 else
-                                     Debug.trace(&quot;custom data not found: &quot; + contentPath);
-                                 outJar.closeEntry();
- 
-                             }
-                         }
-                         // Third we write the list into the
-                         // uninstaller.jar
-                         outJar.putNextEntry(new ZipEntry(key));
-                         ObjectOutputStream objOut = new ObjectOutputStream(outJar);
-                         objOut.writeObject(subContents);
-                         objOut.flush();
-                         outJar.closeEntry();
- 
-                     }
-                     else
-                     {
-                         outJar.putNextEntry(new ZipEntry(key));
-                         if (contents instanceof ByteArrayOutputStream)
-                         {
-                             ((ByteArrayOutputStream) contents).writeTo(outJar);
-                         }
-                         else
-                         {
-                             ObjectOutputStream objOut = new ObjectOutputStream(outJar);
-                             objOut.writeObject(contents);
-                             objOut.flush();
-                         }
-                         outJar.closeEntry();
-                     }
-                 }
-             }
-             // write the files which should be deleted by root for another user
- 
-             outJar.putNextEntry(new ZipEntry(UninstallData.ROOTSCRIPT));
-             ObjectOutputStream rootStream = new ObjectOutputStream(outJar);
- 
-             String rootScript = udata.getRootScript();
 
-             rootStream.writeUTF(rootScript);
- 
-             rootStream.flush();
-             outJar.closeEntry();
+            // ***  ADDED code bellow 
+	    // Write out additional uninstall data
+            // Do not &quot;kill&quot; the installation if there is a problem
+            // with custom uninstall data. Therefore log it to Debug,
+            // but do not throw.
+            Map additionalData = udata.getAdditionalData();
+            if (additionalData != null &amp;&amp; !additionalData.isEmpty())
+            {
+                Iterator keys = additionalData.keySet().iterator();
+                HashSet exist = new HashSet();
+                while (keys != null &amp;&amp; keys.hasNext())
+                {
+                    String key = (String) keys.next();
+                    Object contents = additionalData.get(key);
+                    if (&quot;__uninstallLibs__&quot;.equals(key))
+                    {
+                        Iterator nativeLibIter = ((List) contents).iterator();
+                        while (nativeLibIter != null &amp;&amp; nativeLibIter.hasNext())
+                        {
+                            String nativeLibName = (String) ((List) nativeLibIter.next()).get(0);
+                            byte[] buffer = new byte[5120];
+                            long bytesCopied = 0;
+                            int bytesInBuffer;
+                            outJar.putNextEntry(new ZipEntry(&quot;native/&quot; + nativeLibName));
+                            InputStream in = getClass().getResourceAsStream(
+                                    &quot;/native/&quot; + nativeLibName);
+                            while ((bytesInBuffer = in.read(buffer)) != -1)
+                            {
+                                outJar.write(buffer, 0, bytesInBuffer);
+                                bytesCopied += bytesInBuffer;
+                            }
+                            outJar.closeEntry();
+                        }
+                    }
+                    else if (&quot;uninstallerListeners&quot;.equals(key) || &quot;uninstallerJars&quot;.equals(key))
+                    { // It is a ArrayList of ArrayLists which contains the
+                        // full
+                        // package paths of all needed class files.
+                        // First we create a new ArrayList which contains only
+                        // the full paths for the uninstall listener self; thats
+                        // the first entry of each sub ArrayList.
+                        ArrayList subContents = new ArrayList();
 
+                        // Secound put the class into uninstaller.jar
+                        Iterator listenerIter = ((List) contents).iterator();
+                        while (listenerIter.hasNext())
+                        {
+                            byte[] buffer = new byte[5120];
+                            long bytesCopied = 0;
+                            int bytesInBuffer;
+                            CustomData customData = (CustomData) listenerIter.next();
+                            // First element of the list contains the listener
+                            // class path;
+                            // remind it for later.
+                            if (customData.listenerName != null)
+                                subContents.add(customData.listenerName);
+                            Iterator liClaIter = customData.contents.iterator();
+                            while (liClaIter.hasNext())
+                            {
+                                String contentPath = (String) liClaIter.next();
+                                if (exist.contains(contentPath)) continue;
+                                exist.add(contentPath);
+                                try
+                                {
+                                    outJar.putNextEntry(new ZipEntry(contentPath));
+                                }
+                                catch (ZipException ze)
+                                { // Ignore, or ignore not ?? May be it is a
+                                    // exception because
+                                    // a doubled entry was tried, then we should
+                                    // ignore ...
+                                    Debug.trace(&quot;ZipException in writing custom data: &quot;
+                                            + ze.getMessage());
+                                    continue;
+                                }
+                                InputStream in = getClass().getResourceAsStream(&quot;/&quot; + contentPath);
+                                if (in != null)
+                                {
+                                    while ((bytesInBuffer = in.read(buffer)) != -1)
+                                    {
+                                        outJar.write(buffer, 0, bytesInBuffer);
+                                        bytesCopied += bytesInBuffer;
+                                    }
+                                }
+                                else
+                                    Debug.trace(&quot;custom data not found: &quot; + contentPath);
+                                outJar.closeEntry();
+
+                            }
+                        }
+                        // Third we write the list into the
+                        // uninstaller.jar
+                        outJar.putNextEntry(new ZipEntry(key));
+                        ObjectOutputStream objOut = new ObjectOutputStream(outJar);
+                        objOut.writeObject(subContents);
+                        objOut.flush();
+                        outJar.closeEntry();
+
+                    }
+                    else
+                    {
+                        outJar.putNextEntry(new ZipEntry(key));
+                        if (contents instanceof ByteArrayOutputStream)
+                        {
+                            ((ByteArrayOutputStream) contents).writeTo(outJar);
+                        }
+                        else
+                        {
+                            ObjectOutputStream objOut = new ObjectOutputStream(outJar);
+                            objOut.writeObject(contents);
+                            objOut.flush();
+                        }
+                        outJar.closeEntry();
+                    }
+                }
+            }
+            // write the files which should be deleted by root for another user
+
+            outJar.putNextEntry(new ZipEntry(UninstallData.ROOTSCRIPT));
+            ObjectOutputStream rootStream = new ObjectOutputStream(outJar);
+
+            String rootScript = udata.getRootScript();
+
+            rootStream.writeUTF(rootScript);
+
+            rootStream.flush();
+            outJar.closeEntry();
+
+            // ***  ADDED to this point 
+
             // Cleanup
             outJar.flush();
             outJar.close();


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000579.html">[izpack-changes] r1833 - in izpack-src/trunk: . src/dist-files
</A></li>
	<LI>Next message: <A HREF="000581.html">[izpack-changes] r1835 - in izpack-src/trunk: . lib	src/doc-ng/XHTML src/lib/com/izforge/izpack/installer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#580">[ date ]</a>
              <a href="thread.html#580">[ thread ]</a>
              <a href="subject.html#580">[ subject ]</a>
              <a href="author.html#580">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/izpack-changes">More information about the izpack-changes
mailing list</a><br>
</body></html>
