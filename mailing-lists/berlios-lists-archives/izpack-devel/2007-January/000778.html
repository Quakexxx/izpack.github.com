<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [izpack-devel] Patch 5/6 patch against the current trunk
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:izpack-devel%40lists.berlios.de?Subject=%5Bizpack-devel%5D%20Patch%205/6%20patch%20against%20the%20current%20trunk&In-Reply-To=45A55017.8050905%40iki.fi">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000777.html">
   <LINK REL="Next"  HREF="000779.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[izpack-devel] Patch 5/6 patch against the current trunk</H1>
    <B>Klaus Bartz</B> 
    <A HREF="mailto:izpack-devel%40lists.berlios.de?Subject=%5Bizpack-devel%5D%20Patch%205/6%20patch%20against%20the%20current%20trunk&In-Reply-To=45A55017.8050905%40iki.fi"
       TITLE="[izpack-devel] Patch 5/6 patch against the current trunk">bartzkau at gmx.net
       </A><BR>
    <I>Wed Jan 10 22:29:11 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000777.html">[izpack-devel] Patch 5/6 patch against the current trunk
</A></li>
        <LI>Next message: <A HREF="000779.html">[izpack-devel] Finnish language (was: Patch 5/6 patch against the current trunk)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#778">[ date ]</a>
              <a href="thread.html#778">[ thread ]</a>
              <a href="subject.html#778">[ subject ]</a>
              <a href="author.html#778">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Ari,
thank you for your comment. Are you a Finn?
Our common language file for Finn is a little bit out of date
(3.5 years, half of entries are missing). Do you can revise it?
It is $IZ_HOME/bin/langpack/installer/fin.xml. There is
testLangpacks.ksh in the same directory. With a kornshell you can
dump out the missing entries.

Cheers

Klaus

Am 10.01.2007, 21:44 Uhr, schrieb Ari Voutilainen &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">ari.voutilainen at iki.fi</A>&gt;:

&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I think taking language from OS is the best guess to offer
</I>&gt;<i> readable texts to user. But this should be offered via language
</I>&gt;<i> selection dialog. So situation is this:
</I>&gt;<i>
</I>&gt;<i> langFromOS=yes &amp;&amp; lang pack found =&gt; You have to make your
</I>&gt;<i> installation with that language.
</I>&gt;<i>
</I>&gt;<i> What about if I go to Germany and let's assume I can understand
</I>&gt;<i> only Finnish. My friend have German as regional settings and
</I>&gt;<i> langFromOS is yes and lang pack is found so installer gives me
</I>&gt;<i> German and I would say something... well, at least I wouldn't
</I>&gt;<i> thank developers. This is only one example where this feature
</I>&gt;<i> isn't very good. We cannot be 100 % sure the _user_ wants to use
</I>&gt;<i> that language which is set in a operating system.
</I>&gt;<i>
</I>&gt;<i> If someone wants to offer only one language in the installation I
</I>&gt;<i> think he/she should edit install XML file so that there will be
</I>&gt;<i> only one language and that is used regardless of the regional
</I>&gt;<i> settings. If there is multiple languages let's have a selection
</I>&gt;<i> dialog with the language which is in the system (or english if
</I>&gt;<i> not matched). So I vote for the original behaviour.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Ari
</I>&gt;<i>
</I>&gt;<i> Markus Schlegel wrote:
</I>&gt;&gt;<i> Hi Julien
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I've also made a patch against the current trunk for the
</I>&gt;&gt;<i> &quot;langFromOS&quot;-Feature.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I can not understand why this feature is a problem for the izpack team,
</I>&gt;&gt;<i> since it does not change current behavior. I can understand when the
</I>&gt;&gt;<i> commandline switch (in my original post) was a problem for you. But I
</I>&gt;&gt;<i> changed the implementation to use gui-modifiers. Also I have added the
</I>&gt;&gt;<i> Documentation for it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Please concern, that the Language Selection Dialog is the only part of
</I>&gt;&gt;<i> your installer (except for the uninstaller) that can not be replaced by
</I>&gt;&gt;<i> an other component and that cannot be omitted (if you want to support
</I>&gt;&gt;<i> multiple installer languages).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Mabe there is someone on the users-list that would vote for this
</I>&gt;&gt;<i> feature?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards
</I>&gt;&gt;<i> Markus
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel-bounces at lists.berlios.de</A>
</I>&gt;&gt;<i> [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel-bounces at lists.berlios.de</A>] On Behalf Of Julien Ponge
</I>&gt;&gt;<i> Sent: Tuesday, January 09, 2007 8:40 AM
</I>&gt;&gt;<i> To: <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at lists.berlios.de</A>
</I>&gt;&gt;<i> Subject: Re: [izpack-devel] Next release will be 3.10.0
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi Markus,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> About 5/6: I will have a look again to make my mind, but I am mildly in
</I>&gt;&gt;<i> favour of this patch since there is no consensus about it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ------------------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Index:  
</I>&gt;&gt;<i> C:/deron/tools_/IzPack_TRUNK/src/lib/com/izforge/izpack/installer/GUIInstaller.java
</I>&gt;&gt;<i> ===================================================================
</I>&gt;&gt;<i> ---  
</I>&gt;&gt;<i> C:/deron/tools_/IzPack_TRUNK/src/lib/com/izforge/izpack/installer/GUIInstaller.java	(revision  
</I>&gt;&gt;<i> 1698)
</I>&gt;&gt;<i> +++ C:/deron/tools_/IzPack_TRUNK/src/lib/com/izforge/izpack/installer/GUIInstaller.java	(working  
</I>&gt;&gt;<i> copy)
</I>&gt;&gt;<i> @@ -1,5 +1,5 @@
</I>&gt;&gt;<i>  /*
</I>&gt;&gt;<i> - * $Id:$
</I>&gt;&gt;<i> + * $Id$
</I>&gt;&gt;<i>   * IzPack - Copyright 2001-2006 Julien Ponge, All Rights Reserved.
</I>&gt;&gt;<i>   *
</I>&gt;&gt;<i>   * <A HREF="http://www.izforge.com/izpack/">http://www.izforge.com/izpack/</A>
</I>&gt;&gt;<i> @@ -205,35 +205,57 @@
</I>&gt;&gt;<i>          List availableLangPacks = getAvailableLangPacks();
</I>&gt;&gt;<i>          int npacks = availableLangPacks.size();
</I>&gt;&gt;<i>          if (npacks == 0) throw new Exception(&quot;no language pack  
</I>&gt;&gt;<i> available&quot;);
</I>&gt;&gt;<i> -        String selectedPack;
</I>&gt;&gt;<i> +        String selectedPack = null;
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i> +        //if modifier langFromOS is set to &quot;yes&quot;, we may not display a  
</I>&gt;&gt;<i> dialog and take instead the language from the OS
</I>&gt;&gt;<i> +        //The Langugedialog is displayed anyway, if the installer does  
</I>&gt;&gt;<i> not contain the language that the system runs with.
</I>&gt;&gt;<i> +        if (useLanguageFromOS()){
</I>&gt;&gt;<i> +            Locale l = Locale.getDefault();
</I>&gt;&gt;<i> +            String osCode = l.getISO3Language().toLowerCase();
</I>&gt;&gt;<i> +            if (availableLangPacks.contains(osCode)){
</I>&gt;&gt;<i> +                selectedPack = osCode;
</I>&gt;&gt;<i> +            }else{
</I>&gt;&gt;<i> +                //now let's try the countrycode for backward  
</I>&gt;&gt;<i> compatibility. Think we should take langcode instead...
</I>&gt;&gt;<i> +                osCode = l.getISO3Country().toLowerCase();
</I>&gt;&gt;<i> +                if (availableLangPacks.contains(osCode)){
</I>&gt;&gt;<i> +                    selectedPack = osCode;
</I>&gt;&gt;<i> +                }else{
</I>&gt;&gt;<i> +                    //noop, let the user choose the language...
</I>&gt;&gt;<i> +                }
</I>&gt;&gt;<i> +            }
</I>&gt;&gt;<i> +        }
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i> +        if (selectedPack==null){
</I>&gt;&gt;<i> +            // Dummy Frame
</I>&gt;&gt;<i> +            JFrame frame = new JFrame();
</I>&gt;&gt;<i> +            frame.setIconImage(new  
</I>&gt;&gt;<i> ImageIcon(this.getClass().getResource(&quot;/img/JFrameIcon.png&quot;))
</I>&gt;&gt;<i> +            .getImage());
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -        // Dummy Frame
</I>&gt;&gt;<i> -        JFrame frame = new JFrame();
</I>&gt;&gt;<i> -        frame.setIconImage(new  
</I>&gt;&gt;<i> ImageIcon(this.getClass().getResource(&quot;/img/JFrameIcon.png&quot;))
</I>&gt;&gt;<i> -                .getImage());
</I>&gt;&gt;<i> +            Dimension frameSize = frame.getSize();
</I>&gt;&gt;<i> +            Dimension screenSize =  
</I>&gt;&gt;<i> Toolkit.getDefaultToolkit().getScreenSize();
</I>&gt;&gt;<i> +            frame.setLocation((screenSize.width - frameSize.width) / 2,
</I>&gt;&gt;<i> +                    (screenSize.height - frameSize.height) / 2 - 10);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -        Dimension frameSize = frame.getSize();
</I>&gt;&gt;<i> -        Dimension screenSize =  
</I>&gt;&gt;<i> Toolkit.getDefaultToolkit().getScreenSize();
</I>&gt;&gt;<i> -        frame.setLocation((screenSize.width - frameSize.width) / 2,
</I>&gt;&gt;<i> -                (screenSize.height - frameSize.height) / 2 - 10);
</I>&gt;&gt;<i> +            // We get the langpack name
</I>&gt;&gt;<i> +            if (npacks != 1)
</I>&gt;&gt;<i> +            {
</I>&gt;&gt;<i> +                LanguageDialog picker = new LanguageDialog(frame,  
</I>&gt;&gt;<i> availableLangPacks.toArray());
</I>&gt;&gt;<i> +                 
</I>&gt;&gt;<i> picker.setSelection(Locale.getDefault().getISO3Country().toLowerCase());
</I>&gt;&gt;<i> +                picker.setModal(true);
</I>&gt;&gt;<i> +                picker.toFront();
</I>&gt;&gt;<i> +                //frame.setVisible(true);
</I>&gt;&gt;<i> +                frame.setVisible(false);
</I>&gt;&gt;<i> +                picker.setVisible(true);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -        // We get the langpack name
</I>&gt;&gt;<i> -        if (npacks != 1)
</I>&gt;&gt;<i> -        {
</I>&gt;&gt;<i> -            LanguageDialog picker = new LanguageDialog(frame,  
</I>&gt;&gt;<i> availableLangPacks.toArray());
</I>&gt;&gt;<i> -             
</I>&gt;&gt;<i> picker.setSelection(Locale.getDefault().getISO3Country().toLowerCase());
</I>&gt;&gt;<i> -            picker.setModal(true);
</I>&gt;&gt;<i> -            picker.toFront();
</I>&gt;&gt;<i> -            //frame.setVisible(true);
</I>&gt;&gt;<i> -            frame.setVisible(false);
</I>&gt;&gt;<i> -            picker.setVisible(true);
</I>&gt;&gt;<i> -
</I>&gt;&gt;<i> -            selectedPack = (String) picker.getSelection();
</I>&gt;&gt;<i> -            if (selectedPack == null) throw new  
</I>&gt;&gt;<i> Exception(&quot;installation canceled&quot;);
</I>&gt;&gt;<i> +                selectedPack = (String) picker.getSelection();
</I>&gt;&gt;<i> +                if (selectedPack == null) throw new  
</I>&gt;&gt;<i> Exception(&quot;installation canceled&quot;);
</I>&gt;&gt;<i> +            }
</I>&gt;&gt;<i> +            else
</I>&gt;&gt;<i> +            {
</I>&gt;&gt;<i> +                selectedPack = (String) availableLangPacks.get(0);
</I>&gt;&gt;<i> +            }
</I>&gt;&gt;<i>          }
</I>&gt;&gt;<i> -        else
</I>&gt;&gt;<i> -            selectedPack = (String) availableLangPacks.get(0);
</I>&gt;&gt;<i> -
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i>          // We add an xml data information
</I>&gt;&gt;<i>          this.installdata.xmlData.setAttribute(&quot;langpack&quot;,  
</I>&gt;&gt;<i> selectedPack);
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> @@ -440,6 +462,20 @@
</I>&gt;&gt;<i>          return (true);
</I>&gt;&gt;<i>      }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> +    /**
</I>&gt;&gt;<i> +     * Returns whether the Language Selection Dialog should be  
</I>&gt;&gt;<i> displayed even if the Installer contains a language matching the  
</I>&gt;&gt;<i> System's language.
</I>&gt;&gt;<i> +     *
</I>&gt;&gt;<i> +     * @return true if the gui-modifier &quot;langFromOS&quot; was set to &quot;yes&quot;,  
</I>&gt;&gt;<i> false otherwise
</I>&gt;&gt;<i> +     */
</I>&gt;&gt;<i> +     protected boolean useLanguageFromOS()
</I>&gt;&gt;<i> +     {
</I>&gt;&gt;<i> +         if (installdata.guiPrefs.modifier.containsKey(&quot;langFromOS&quot;)
</I>&gt;&gt;<i> +                &amp;&amp; &quot;yes&quot;.equalsIgnoreCase((String)  
</I>&gt;&gt;<i> installdata.guiPrefs.modifier.get(&quot;langFromOS&quot;)))
</I>&gt;&gt;<i> +             return (true);
</I>&gt;&gt;<i> +         else
</I>&gt;&gt;<i> +             return (false);
</I>&gt;&gt;<i> +     }
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i>      /**
</I>&gt;&gt;<i>       * Returns the type in which the language should be displayed in  
</I>&gt;&gt;<i> the language selction dialog.
</I>&gt;&gt;<i>       * Possible are &quot;iso3&quot;, &quot;native&quot; and &quot;usingDefault&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ------------------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Index: C:/deron/tools_/IzPack_TRUNK/src/doc-ng/XHTML/node5.html
</I>&gt;&gt;<i> ===================================================================
</I>&gt;&gt;<i> --- C:/deron/tools_/IzPack_TRUNK/src/doc-ng/XHTML/node5.html	(revision  
</I>&gt;&gt;<i> 1698)
</I>&gt;&gt;<i> +++ C:/deron/tools_/IzPack_TRUNK/src/doc-ng/XHTML/node5.html	(working  
</I>&gt;&gt;<i> copy)
</I>&gt;&gt;<i> @@ -273,6 +273,16 @@
</I>&gt;&gt;<i>          language will be used if possible, else the notation of the  
</I>&gt;&gt;<i> default locale. Using &quot;default&quot;
</I>&gt;&gt;<i>          will be presented the language in the notation of the default  
</I>&gt;&gt;<i> locale of the VM.
</I>&gt;&gt;<i>        &lt;/li&gt;
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i> +      &lt;li&gt;
</I>&gt;&gt;<i> +        &lt;tt&gt;langFromOS&lt;/tt&gt;:&lt;br /&gt;
</I>&gt;&gt;<i> +        possible are &quot;yes&quot; or &quot;no&quot;. Default (when ommitted) is &quot;no&quot;.  
</I>&gt;&gt;<i> If it is set to &quot;yes&quot;,
</I>&gt;&gt;<i> +        the installer first checks if the system runs with a language  
</I>&gt;&gt;<i> supported by the installer
</I>&gt;&gt;<i> +        and ommits the Lanugage Selection Dialog if so. If the System  
</I>&gt;&gt;<i> runs with a Language not
</I>&gt;&gt;<i> +        supported by the installer, the Language Selection Dialog is  
</I>&gt;&gt;<i> displayed neverthless. &lt;br /&gt;
</I>&gt;&gt;<i> +        Example: If you have an Installer supporting German and  
</I>&gt;&gt;<i> English with &quot;langFromOS=yes&quot;,
</I>&gt;&gt;<i> +        the dialog will show up on french systems but not on german or  
</I>&gt;&gt;<i> english ones.
</I>&gt;&gt;<i> +      &lt;/li&gt;
</I>&gt;&gt;<i>      &lt;/ul&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      &lt;h2&gt;&lt;a id=&quot;modifyingPanels&quot; name=&quot;modifyingPanels&quot;&gt;Modifying  
</I>&gt;&gt;<i> IzPack Panels&lt;/a&gt;&lt;/h2&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ------------------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> izpack-devel mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at lists.berlios.de</A>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">https://lists.berlios.de/mailman/listinfo/izpack-devel</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> izpack-devel mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">https://lists.berlios.de/mailman/listinfo/izpack-devel</A>
</I>&gt;<i>
</I>&gt;<i> __________ NOD32 1.1392 (20060202) Information __________
</I>&gt;<i>
</I>&gt;<i> Diese E-Mail wurde vom NOD32 Antivirus System gepr&#252;ft
</I>&gt;<i> <A HREF="http://www.nod32.com">http://www.nod32.com</A>
</I>&gt;<i>
</I>&gt;<i>
</I>


-- 
Erstellt mit Operas revolution&#228;rem E-Mail-Modul: <A HREF="http://www.opera.com/mail/">http://www.opera.com/mail/</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000777.html">[izpack-devel] Patch 5/6 patch against the current trunk
</A></li>
	<LI>Next message: <A HREF="000779.html">[izpack-devel] Finnish language (was: Patch 5/6 patch against the current trunk)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#778">[ date ]</a>
              <a href="thread.html#778">[ thread ]</a>
              <a href="subject.html#778">[ subject ]</a>
              <a href="author.html#778">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/izpack-devel">More information about the izpack-devel
mailing list</a><br>
</body></html>
