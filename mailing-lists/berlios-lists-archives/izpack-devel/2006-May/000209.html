<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [izpack-devel] Shortcut Panel Crashes on Windows 2000
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:izpack-devel%40lists.berlios.de?Subject=%5Bizpack-devel%5D%20Shortcut%20Panel%20Crashes%20on%20Windows%202000&In-Reply-To=200605302032.57211.hal%40thresholddigital.com">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000208.html">
   <LINK REL="Next"  HREF="000210.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[izpack-devel] Shortcut Panel Crashes on Windows 2000</H1>
    <B>Elmar Grom</B> 
    <A HREF="mailto:izpack-devel%40lists.berlios.de?Subject=%5Bizpack-devel%5D%20Shortcut%20Panel%20Crashes%20on%20Windows%202000&In-Reply-To=200605302032.57211.hal%40thresholddigital.com"
       TITLE="[izpack-devel] Shortcut Panel Crashes on Windows 2000">elmar at grom.net
       </A><BR>
    <I>Wed May 31 02:54:16 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000208.html">[izpack-devel] Shortcut Panel Crashes on Windows 2000
</A></li>
        <LI>Next message: <A HREF="000210.html">[izpack-devel] Shortcut Panel Crashes on Windows 2000
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#209">[ date ]</a>
              <a href="thread.html#209">[ thread ]</a>
              <a href="subject.html#209">[ subject ]</a>
              <a href="author.html#209">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hal,

hmmmm, interesting...

I think it would be a good idea to try to isolate this problem to the use of
a specific module. From what you write it sounds very much like the shortcut
panel is the culprit. However, there is no proof at this point. So before
spending a lot of time on digging into this area it might be valuable to
first make sure it is actually in this module.

The 20 min thing is not exactly helping... can you put a dummy together that
does not take that long to build and see if that exhibits the same problem?
if so, we can use that to debug the problem if not we would probably have to
search into an entirely different direction...

BTW, I got to go and drink some beer pretty soon, you can reach me for about
another 1/2 hour and after that tomorrow morning again (US Pacific Time).

	Elmar


-----Original Message-----
From: <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel-admin at berlios.de</A>
[mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel-admin at berlios.de</A>]On Behalf Of Hal Vaughan
Sent: Tuesday, May 30, 2006 5:33 PM
To: <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at berlios.de</A>
Subject: Re: [izpack-devel] Shortcut Panel Crashes on Windows 2000


On Tuesday 30 May 2006 18:43, Elmar Grom wrote:
&gt;<i> Hal,
</I>&gt;<i>
</I>&gt;<i> sure there is a DLL. As I wrote in the last mail, it just uses
</I>&gt;<i> regular OS calls, nothing off the hook. I even developed it on
</I>&gt;<i> Windows 2000 and it is in use for years now with no reports of this
</I>&gt;<i> kind...
</I>
Okay.  I forgot who write the DLL.  I see what you're saying.  My
misunderstanding.

&gt;<i> In theory Java should not cause such problems. In reality I have seen
</I>&gt;<i> the odd strange thing, though not in a while...
</I>
What's weird is that it isn't a crash, a blue-screen-of-death, or
anything else.  It's a total reboot, and I just can't imagine a darn
thing in Java doing that.  I can try redirecting the output and errors
to a file next time, if you think that'll help.

&gt;<i> At this point I have no idea at all what it could be, so the strategy
</I>&gt;<i> is to change various things that might alter the operating conditions
</I>&gt;<i> enough to stop this from happening or to change what exactly happens.
</I>
I know it works in WinXP.  I haven't experimented too much yet, since it
takes 20 minutes to compile the Install.jar!  I'm open to ideas of what
to change.

&gt;<i> If we can accomplish that, we might already gain some insight or at
</I>&gt;<i> least devise a strategy that allows us to hone in on the problem.
</I>
I can try different settings.  I think it best to remove one of the
short cuts and that could narrow it down quickly.  I was worried that
the SimpleConfig.class that Fabrice and I have been working on could
cause some problem, but it's not in use at all when ShortcutPanel is
working -- and I just don't see what could be going on in Java that
could automatically reboot the system.

&gt;<i> One thing of interest would also be the VM you are running. Perhaps
</I>&gt;<i> changing that might also change things.... and then there is always
</I>&gt;<i> the outside possibility of something being wrong with you OS
</I>&gt;<i> installation (corrupted file etc.).
</I>
It could be any of those.  It's on a multi-partitioned system, and the
partition was set up for testing, so it would be a pain to reinstall
Windows, since I'd still have to go back and re-install GRUB over the
boot block and make sure the config is okay.

I'm using Java 1.5, if that helps.

Hal

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel-admin at berlios.de</A>
</I>&gt;<i> [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel-admin at berlios.de</A>]On Behalf Of Hal Vaughan
</I>&gt;<i> Sent: Tuesday, May 30, 2006 12:19 PM
</I>&gt;<i> To: <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at berlios.de</A>
</I>&gt;<i> Subject: Re: [izpack-devel] Shortcut Panel Crashes on Windows 2000
</I>&gt;<i>
</I>&gt;<i> On Tuesday 30 May 2006 15:10, Elmar Grom wrote:
</I>&gt;<i> &gt; Hi Hal,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I never heard of such behavior. There is also nothing in the code
</I>&gt;<i> &gt; that could cause the OS to reboot. In theory it should not be
</I>&gt;<i> &gt; possible to cause this from within a Java application and the
</I>&gt;<i> &gt; native code uses regular OS calls, no trickery or smoke and
</I>&gt;<i> &gt; mirrors. So that makes the entire situation really strange.
</I>&gt;<i>
</I>&gt;<i> Isn't there a native .dll that could cause some problems?  The
</I>&gt;<i> shortcuts are never even created and I don't see any sign of them on
</I>&gt;<i> reboot.
</I>&gt;<i>
</I>&gt;<i> &gt; Just to explore the situation a bit more, could you try to insert
</I>&gt;<i> &gt; another panel after the shortcut panel and see what happens?
</I>&gt;<i>
</I>&gt;<i> Are you thinking it might be the next panel?  I can try that later
</I>&gt;<i> this evening.  I'll also be glad to use any debugging tools you
</I>&gt;<i> recommend, provided I understand what I'm doing.  (There's a big gulf
</I>&gt;<i> of skills if you're self taught!)
</I>&gt;<i>
</I>&gt;<i> Hal
</I>&gt;<i>
</I>&gt;<i> &gt; 	Elmar
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -----Original Message-----
</I>&gt;<i> &gt; From: <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel-admin at berlios.de</A>
</I>&gt;<i> &gt; [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel-admin at berlios.de</A>]On Behalf Of Hal Vaughan
</I>&gt;<i> &gt; Sent: Tuesday, May 30, 2006 9:39 AM
</I>&gt;<i> &gt; To: <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at lists.berlios.de</A>
</I>&gt;<i> &gt; Subject: [izpack-devel] Shortcut Panel Crashes on Windows 2000
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I wanted to bring this up here before I submitted it as a bug,
</I>&gt;<i> &gt; since I have no debugging info (it just crashes!).  I've included
</I>&gt;<i> &gt; my shortcutSpec.xml at the bottom of this e-mail, in case there's
</I>&gt;<i> &gt; something I missed that could create a problem.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I'm using a shortcut panel as the last functional step in
</I>&gt;<i> &gt; installing my program.  It works fine on Windows XP, but whenever I
</I>&gt;<i> &gt; get the ShortcutPanel on Windows 2000, when I click &quot;Next&quot;, instead
</I>&gt;<i> &gt; of getting shortcuts, my computer reboots.  As you can imagine,
</I>&gt;<i> &gt; this means I can either not support Windows 2000 or come up with
</I>&gt;<i> &gt; really crazy work around.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Has anyone else seen this behavior?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I've got working directories set, but the shortcuts are to .vbs
</I>&gt;<i> &gt; files that don't really need environment variables.  They figure
</I>&gt;<i> &gt; out where they are and then run .bat files in the same directory
</I>&gt;<i> &gt; with a few arguments the .vbs scripts figure out on their own.  I'm
</I>&gt;<i> &gt; not using special icons (just the standard .vbs icon) either.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any ideas on this would be helpful.  I think it's likely a bug of
</I>&gt;<i> &gt; some kind, but I'm once again working on very little sleep for a
</I>&gt;<i> &gt; number of days, so I could be missing the extremely obvious.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hal
</I>&gt;<i> &gt; ----------------------------shortcutSpec.xml-----------------------
</I>&gt;<i> &gt;-- ------- -----
</I>&gt;<i> &gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot; ?&gt;
</I>&gt;<i> &gt; &lt;shortcuts&gt;
</I>&gt;<i> &gt; 	&lt;skipIfNotSupported/&gt;
</I>&gt;<i> &gt; 	&lt;programGroup defaultName=&quot;threshNet Agent&quot; location=&quot;startMenu&quot;/&gt;
</I>&gt;<i> &gt; 	&lt;shortcut
</I>&gt;<i> &gt; 				name=&quot;threshNet Control Panel&quot;
</I>&gt;<i> &gt; 				target=&quot;$INSTALL_PATH\TNetControlPanel.vbs&quot;
</I>&gt;<i> &gt; 				commandLine=&quot;&quot;
</I>&gt;<i> &gt; 				workingDirectory=&quot;$INSTALL_PATH\&quot;
</I>&gt;<i> &gt; 				description=&quot;Runs the threshNet Control Panel&quot;
</I>&gt;<i> &gt; 				initialState=&quot;noShow&quot;
</I>&gt;<i> &gt; 				programGroup=&quot;yes&quot;
</I>&gt;<i> &gt; 				desktop=&quot;yes&quot;
</I>&gt;<i> &gt; 				applications=&quot;no&quot;
</I>&gt;<i> &gt; 				startMenu=&quot;no&quot;
</I>&gt;<i> &gt; 				startup=&quot;no&quot;&gt;
</I>&gt;<i> &gt; 		&lt;createForPack name=&quot;threshNetAgent&quot;/&gt;
</I>&gt;<i> &gt; 	&lt;/shortcut&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 	&lt;shortcut
</I>&gt;<i> &gt; 				name=&quot;threshNet Test&quot;
</I>&gt;<i> &gt; 				target=&quot;$INSTALL_PATH\TNetTest.vbs&quot;
</I>&gt;<i> &gt; 				commandLine=&quot;&quot;
</I>&gt;<i> &gt; 				workingDirectory=&quot;$INSTALL_PATH\&quot;
</I>&gt;<i> &gt; 				description=&quot;Runs tests to verify threshNet Agent functions&quot;
</I>&gt;<i> &gt; 				initialState=&quot;noShow&quot;
</I>&gt;<i> &gt; 				programGroup=&quot;yes&quot;
</I>&gt;<i> &gt; 				desktop=&quot;no&quot;
</I>&gt;<i> &gt; 				applications=&quot;no&quot;
</I>&gt;<i> &gt; 				startMenu=&quot;no&quot;
</I>&gt;<i> &gt; 				startup=&quot;no&quot;&gt;
</I>&gt;<i> &gt; 		&lt;createForPack name=&quot;threshNetAgent&quot;/&gt;
</I>&gt;<i> &gt; 	&lt;/shortcut&gt;
</I>&gt;<i> &gt; &lt;/shortcuts&gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; izpack-devel mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at lists.berlios.de</A>
</I>&gt;<i> &gt; <A HREF="http://lists.berlios.de/mailman/listinfo/izpack-devel">http://lists.berlios.de/mailman/listinfo/izpack-devel</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; izpack-devel mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at lists.berlios.de</A>
</I>&gt;<i> &gt; <A HREF="http://lists.berlios.de/mailman/listinfo/izpack-devel">http://lists.berlios.de/mailman/listinfo/izpack-devel</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> izpack-devel mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at lists.berlios.de</A>
</I>&gt;<i> <A HREF="http://lists.berlios.de/mailman/listinfo/izpack-devel">http://lists.berlios.de/mailman/listinfo/izpack-devel</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> izpack-devel mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at lists.berlios.de</A>
</I>&gt;<i> <A HREF="http://lists.berlios.de/mailman/listinfo/izpack-devel">http://lists.berlios.de/mailman/listinfo/izpack-devel</A>
</I>_______________________________________________
izpack-devel mailing list
<A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">izpack-devel at lists.berlios.de</A>
<A HREF="http://lists.berlios.de/mailman/listinfo/izpack-devel">http://lists.berlios.de/mailman/listinfo/izpack-devel</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000208.html">[izpack-devel] Shortcut Panel Crashes on Windows 2000
</A></li>
	<LI>Next message: <A HREF="000210.html">[izpack-devel] Shortcut Panel Crashes on Windows 2000
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#209">[ date ]</a>
              <a href="thread.html#209">[ thread ]</a>
              <a href="subject.html#209">[ subject ]</a>
              <a href="author.html#209">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/izpack-devel">More information about the izpack-devel
mailing list</a><br>
</body></html>
